vocab_size: 32000

# Image/tokenization
input_size: [32, 32]
patch_size: 8
image_ar_dim: 96
num_mixtures: 256
use_bfloat16_img_head: false

# Flow (Jet) â€” post-flow factoring
jet_depth: 16
jet_block_depth: 3
jet_emb_dim: 256
jet_num_heads: 8
flow_actnorm: false
flow_invertible_dense: false
latent_projection: learned
pre_factor_dim: null  # keep POST-flow factoring
# channel_repeat: 0  # note: currently unused by the model

# AR Transformer
d_model: 256
n_heads: 4
n_layers: 8
d_ff: 1024
n_kv_heads: 1
dropout: 0.1
max_seq_len: 16

# Conditioning (class-conditional CIFAR-10)
num_classes: 10
class_token_length: 16
cfg_drop_prob: 0.1
cfg_strength: 4.0
cfg_mode: "reject"

# Dataset / training target
dataset: cifar10

# Optimization / curriculum
batch_size: 256
learning_rate: 0.0001
warmup_percent: 0.05
use_cosine: true
weight_decay: 0.0001
opt_b1: 0.9
opt_b2: 0.95
grad_clip_norm: 1.0
num_epochs: 200
precision: bf16
torch_compile: false
grad_checkpoint_transformer: false
flow_grad_checkpoint: false

# EMA
ema:
  enabled: false

# Noise curriculum
rgb_sigma0: 16.0
rgb_sigma_final: 0.0
noise_curriculum_epochs: 20
latent_noise_std: 0.1
text_loss_weight: 0.0
image_loss_weight: 1.0
grad_accum_steps: 1

# Epoch-level schedules
sample_every_epochs: 5
val_every_epochs: 5

# Evaluation controls
eval_no_rgb_noise: true
fid_every_epochs: 0
is_every_epochs: 0
fid_is_num_samples: 0
advanced_metrics: true

# Dataloader / augmentation
num_workers: 8
max_samples: null
ignore_pad: false
random_flip_prob: 0.5

# Accelerator
accelerator: auto
device: auto

# W&B
wandb: true
wandb_offline: false
wandb_project: "jetformer-cifar10-32"
wandb_run_name: "CIFAR10-32"
wandb_tags: ["cifar10", "32x32", "small"]